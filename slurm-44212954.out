/cluster/home/hugifl/scim/utils_data_prep.py:420: FutureWarning: X.dtype being converted to np.float32 from float64. In the next version of anndata (0.9) conversion will not be automatic. Pass dtype explicitly to avoid this warning. Pass `AnnData(X, dtype=X.dtype, ...)` to get the future behavour.
  adata = ad.AnnData(X=data_matrix, obs=metadata)
/cluster/home/hugifl/.local/lib/python3.7/site-packages/anndata/_core/anndata.py:121: ImplicitModificationWarning: Transforming to str index.
  warnings.warn("Transforming to str index.", ImplicitModificationWarning)
computing common genes
number of common genes:  10242
filtering and saving dataset 1
conc:  0.1
number of all genes:  12388
shape of counts:  (1345, 12388)
shape of filtered counts:  (1345, 10242)
number of filtered genes:  10242
conc:  0.25
number of all genes:  10884
shape of counts:  (585, 10884)
shape of filtered counts:  (585, 10242)
number of filtered genes:  10242
conc:  0.5
number of all genes:  12102
shape of counts:  (1110, 12102)
shape of filtered counts:  (1110, 10242)
number of filtered genes:  10242
conc:  1
number of all genes:  11660
shape of counts:  (827, 11660)
shape of filtered counts:  (827, 10242)
number of filtered genes:  10242
conc:  2
number of all genes:  12732
shape of counts:  (1688, 12732)
shape of filtered counts:  (1688, 10242)
number of filtered genes:  10242
filtering and saving dataset 2
conc:  0.1
number of all genes:  10366
shape of counts:  (553, 10366)
shape of filtered counts:  (553, 10242)
number of filtered genes:  10242
conc:  0.5
number of all genes:  12213
shape of counts:  (1448, 12213)
shape of filtered counts:  (1448, 10242)
number of filtered genes:  10242
conc:  1
number of all genes:  11968
shape of counts:  (1213, 11968)
shape of filtered counts:  (1213, 10242)
number of filtered genes:  10242
conc:  2
number of all genes:  11987
shape of counts:  (1440, 11987)
shape of filtered counts:  (1440, 10242)
number of filtered genes:  10242
Number of cells from conc 0.1 before filtering: 1345
Number of cells from conc 0.1 after filtering: 1186
entry of first ADT field: 200.0
shape of adt_data: (1186, 30)
Number of cells from conc 0.25 before filtering: 585
Number of cells from conc 0.25 after filtering: 514
entry of first ADT field: 162.0
shape of adt_data: (514, 30)
Number of cells from conc 0.5 before filtering: 1110
Number of cells from conc 0.5 after filtering: 964
entry of first ADT field: 193.0
shape of adt_data: (964, 30)
Number of cells from conc 1 before filtering: 827
Number of cells from conc 1 after filtering: 724
entry of first ADT field: 225.0
shape of adt_data: (724, 30)
Number of cells from conc 2 before filtering: 1688
Number of cells from conc 2 after filtering: 1478
entry of first ADT field: 216.0
shape of adt_data: (1478, 30)
Number of cells from conc 0.1 before filtering: 553
Number of cells from conc 0.1 after filtering: 492
entry of first ADT field: 1391.0
shape of adt_data: (492, 16)
Number of cells from conc 0.5 before filtering: 1448
Number of cells from conc 0.5 after filtering: 1283
entry of first ADT field: 2819.0
shape of adt_data: (1283, 16)
Number of cells from conc 1 before filtering: 1213
Number of cells from conc 1 after filtering: 1077
entry of first ADT field: 2930.0
shape of adt_data: (1077, 16)
Number of cells from conc 2 before filtering: 1440
Number of cells from conc 2 after filtering: 1271
entry of first ADT field: 1031.0
shape of adt_data: (1271, 16)
Data saved to /cluster/scratch/hugifl/9_glycomics_2/AB.h5ad
Data saved to /cluster/scratch/hugifl/9_glycomics_2/lectin.h5ad
