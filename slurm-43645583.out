/cluster/home/hugifl/.local/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/home/hugifl/.local/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/cluster/home/hugifl/.local/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
computing common genes
number of common genes:  10242
filtering and saving dataset 1
conc:  0.1
conc:  0.25
conc:  0.5
conc:  1
conc:  2
filtering and saving dataset 2
conc:  0.1
conc:  0.5
conc:  1
conc:  2
Number of cells from conc 0.1 before filtering: 1345
Number of cells from conc 0.1 after filtering: 1186
entry of first ADT field: 200.0
shape of adt_data: (1186, 30)
Number of cells from conc 0.25 before filtering: 585
Number of cells from conc 0.25 after filtering: 514
entry of first ADT field: 162.0
shape of adt_data: (514, 30)
Number of cells from conc 0.5 before filtering: 1110
Number of cells from conc 0.5 after filtering: 964
entry of first ADT field: 193.0
shape of adt_data: (964, 30)
Number of cells from conc 1 before filtering: 827
Number of cells from conc 1 after filtering: 724
entry of first ADT field: 225.0
shape of adt_data: (724, 30)
Number of cells from conc 2 before filtering: 1688
Number of cells from conc 2 after filtering: 1478
entry of first ADT field: 216.0
shape of adt_data: (1478, 30)
Number of cells from conc 0.1 before filtering: 553
Number of cells from conc 0.1 after filtering: 492
entry of first ADT field: 1391.0
shape of adt_data: (492, 16)
Number of cells from conc 0.5 before filtering: 1448
Number of cells from conc 0.5 after filtering: 1283
entry of first ADT field: 2819.0
shape of adt_data: (1283, 16)
Number of cells from conc 1 before filtering: 1213
Number of cells from conc 1 after filtering: 1077
entry of first ADT field: 2930.0
shape of adt_data: (1077, 16)
Number of cells from conc 2 before filtering: 1440
Number of cells from conc 2 after filtering: 1271
entry of first ADT field: 1031.0
shape of adt_data: (1271, 16)
initializing and training the Random Forest classifier
predicting on the test set and print the classification report
              precision    recall  f1-score   support

           1       0.58      0.63      0.60        67
           3       0.00      0.00      0.00         4
           4       0.96      0.97      0.96      2153
           5       0.77      0.97      0.86       338
           6       0.00      0.00      0.00        17
           7       0.50      0.03      0.05       118

    accuracy                           0.92      2697
   macro avg       0.47      0.43      0.41      2697
weighted avg       0.90      0.92      0.89      2697

plotting the feature importances
Top 1 out of 100 features being tested
Top 2 out of 100 features being tested
Top 3 out of 100 features being tested
Top 4 out of 100 features being tested
Top 5 out of 100 features being tested
Top 6 out of 100 features being tested
Top 7 out of 100 features being tested
Top 8 out of 100 features being tested
Top 9 out of 100 features being tested
Top 10 out of 100 features being tested
Top 11 out of 100 features being tested
Top 12 out of 100 features being tested
Top 13 out of 100 features being tested
Top 14 out of 100 features being tested
Top 15 out of 100 features being tested
Top 16 out of 100 features being tested
Top 17 out of 100 features being tested
Top 18 out of 100 features being tested
Top 19 out of 100 features being tested
Top 20 out of 100 features being tested
Top 21 out of 100 features being tested
Top 22 out of 100 features being tested
Top 23 out of 100 features being tested
Top 24 out of 100 features being tested
Top 25 out of 100 features being tested
Top 26 out of 100 features being tested
Top 27 out of 100 features being tested
Top 28 out of 100 features being tested
Top 29 out of 100 features being tested
Top 30 out of 100 features being tested
Top 31 out of 100 features being tested
Top 32 out of 100 features being tested
Top 33 out of 100 features being tested
Top 34 out of 100 features being tested
Top 35 out of 100 features being tested
Top 36 out of 100 features being tested
Top 37 out of 100 features being tested
Top 38 out of 100 features being tested
Top 39 out of 100 features being tested
Top 40 out of 100 features being tested
Top 41 out of 100 features being tested
Top 42 out of 100 features being tested
Top 43 out of 100 features being tested
Top 44 out of 100 features being tested
Top 45 out of 100 features being tested
Top 46 out of 100 features being tested
Top 47 out of 100 features being tested
Top 48 out of 100 features being tested
Top 49 out of 100 features being tested
Top 50 out of 100 features being tested
Top 51 out of 100 features being tested
Top 52 out of 100 features being tested
Top 53 out of 100 features being tested
Top 54 out of 100 features being tested
Top 55 out of 100 features being tested
Top 56 out of 100 features being tested
Top 57 out of 100 features being tested
Top 58 out of 100 features being tested
Top 59 out of 100 features being tested
Top 60 out of 100 features being tested
Top 61 out of 100 features being tested
Top 62 out of 100 features being tested
Top 63 out of 100 features being tested
Top 64 out of 100 features being tested
Top 65 out of 100 features being tested
Top 66 out of 100 features being tested
Top 67 out of 100 features being tested
Top 68 out of 100 features being tested
Top 69 out of 100 features being tested
Top 70 out of 100 features being tested
Top 71 out of 100 features being tested
Top 72 out of 100 features being tested
Top 73 out of 100 features being tested
Top 74 out of 100 features being tested
Top 75 out of 100 features being tested
Top 76 out of 100 features being tested
Top 77 out of 100 features being tested
Top 78 out of 100 features being tested
Top 79 out of 100 features being tested
Top 80 out of 100 features being tested
Top 81 out of 100 features being tested
Top 82 out of 100 features being tested
Top 83 out of 100 features being tested
Top 84 out of 100 features being tested
Top 85 out of 100 features being tested
Top 86 out of 100 features being tested
Top 87 out of 100 features being tested
Top 88 out of 100 features being tested
Top 89 out of 100 features being tested
Top 90 out of 100 features being tested
Top 91 out of 100 features being tested
Top 92 out of 100 features being tested
Top 93 out of 100 features being tested
Top 94 out of 100 features being tested
Top 95 out of 100 features being tested
Top 96 out of 100 features being tested
Top 97 out of 100 features being tested
Top 98 out of 100 features being tested
Top 99 out of 100 features being tested
Top 100 out of 100 features being tested
25 of the 200 most highly variable genes were also in the top 40 cell type marker genes.
length of final gene set:  239
Traceback (most recent call last):
  File "data_prep.py", line 72, in <module>
    filtered_AB_data, filtered_lectin_data = filter_genes_for_analysis(celltype_markers, hvg_results, AB_log_transformed_gene_data, lectin_log_transformed_gene_data, common_genes)
  File "/cluster/home/hugifl/scim/utils_data_prep.py", line 372, in filter_genes_for_analysis
    assert len(final_gene_set) == 240, "Final gene set does not contain 240 unique genes."
AssertionError: Final gene set does not contain 240 unique genes.
