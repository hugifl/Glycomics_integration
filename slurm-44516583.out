/cluster/home/hugifl/scim/utils_data_prep.py:424: FutureWarning: X.dtype being converted to np.float32 from float64. In the next version of anndata (0.9) conversion will not be automatic. Pass dtype explicitly to avoid this warning. Pass `AnnData(X, dtype=X.dtype, ...)` to get the future behavour.
  adata = ad.AnnData(X=data_matrix, obs=metadata)
/cluster/home/hugifl/.local/lib/python3.7/site-packages/anndata/_core/anndata.py:121: ImplicitModificationWarning: Transforming to str index.
  warnings.warn("Transforming to str index.", ImplicitModificationWarning)
computing common genes
number of common genes:  10242
filtering and saving dataset 1
conc:  0.1
number of all genes:  12388
shape of counts:  (1345, 12388)
shape of filtered counts:  (1345, 10242)
number of filtered genes:  10242
conc:  0.25
number of all genes:  10884
shape of counts:  (585, 10884)
shape of filtered counts:  (585, 10242)
number of filtered genes:  10242
conc:  0.5
number of all genes:  12102
shape of counts:  (1110, 12102)
shape of filtered counts:  (1110, 10242)
number of filtered genes:  10242
conc:  1
number of all genes:  11660
shape of counts:  (827, 11660)
shape of filtered counts:  (827, 10242)
number of filtered genes:  10242
conc:  2
number of all genes:  12732
shape of counts:  (1688, 12732)
shape of filtered counts:  (1688, 10242)
number of filtered genes:  10242
filtering and saving dataset 2
conc:  0.1
number of all genes:  10366
shape of counts:  (553, 10366)
shape of filtered counts:  (553, 10242)
number of filtered genes:  10242
conc:  0.5
number of all genes:  12213
shape of counts:  (1448, 12213)
shape of filtered counts:  (1448, 10242)
number of filtered genes:  10242
conc:  1
number of all genes:  11968
shape of counts:  (1213, 11968)
shape of filtered counts:  (1213, 10242)
number of filtered genes:  10242
conc:  2
number of all genes:  11987
shape of counts:  (1440, 11987)
shape of filtered counts:  (1440, 10242)
number of filtered genes:  10242
Number of cells from conc 0.1 before filtering: 1345
Number of cells from conc 0.1 after filtering: 1061
entry of first ADT field: 200.0
shape of adt_data: (1061, 30)
Number of cells from conc 0.25 before filtering: 585
Number of cells from conc 0.25 after filtering: 445
entry of first ADT field: 162.0
shape of adt_data: (445, 30)
Number of cells from conc 0.5 before filtering: 1110
Number of cells from conc 0.5 after filtering: 859
entry of first ADT field: 193.0
shape of adt_data: (859, 30)
Number of cells from conc 1 before filtering: 827
Number of cells from conc 1 after filtering: 661
entry of first ADT field: 225.0
shape of adt_data: (661, 30)
Number of cells from conc 2 before filtering: 1688
Number of cells from conc 2 after filtering: 1355
entry of first ADT field: 216.0
shape of adt_data: (1355, 30)
Number of cells from conc 0.1 before filtering: 553
Number of cells from conc 0.1 after filtering: 453
entry of first ADT field: 1391.0
shape of adt_data: (453, 16)
Number of cells from conc 0.5 before filtering: 1448
Number of cells from conc 0.5 after filtering: 1237
entry of first ADT field: 2819.0
shape of adt_data: (1237, 16)
Number of cells from conc 1 before filtering: 1213
Number of cells from conc 1 after filtering: 1034
entry of first ADT field: 2930.0
shape of adt_data: (1034, 16)
Number of cells from conc 2 before filtering: 1440
Number of cells from conc 2 after filtering: 1196
entry of first ADT field: 1031.0
shape of adt_data: (1196, 16)
initializing and training the Random Forest classifier
predicting on the test set and print the classification report
              precision    recall  f1-score   support

           4       0.99      0.98      0.99      2153
           5       0.89      0.93      0.91       338

    accuracy                           0.98      2491
   macro avg       0.94      0.96      0.95      2491
weighted avg       0.98      0.98      0.98      2491

plotting the feature importances
Top 1 out of 100 features being tested
Top 2 out of 100 features being tested
Top 3 out of 100 features being tested
Top 4 out of 100 features being tested
Top 5 out of 100 features being tested
Top 6 out of 100 features being tested
Top 7 out of 100 features being tested
Top 8 out of 100 features being tested
Top 9 out of 100 features being tested
Top 10 out of 100 features being tested
Top 11 out of 100 features being tested
Top 12 out of 100 features being tested
Top 13 out of 100 features being tested
Top 14 out of 100 features being tested
Top 15 out of 100 features being tested
Top 16 out of 100 features being tested
Top 17 out of 100 features being tested
Top 18 out of 100 features being tested
Top 19 out of 100 features being tested
Top 20 out of 100 features being tested
Top 21 out of 100 features being tested
Top 22 out of 100 features being tested
Top 23 out of 100 features being tested
Top 24 out of 100 features being tested
Top 25 out of 100 features being tested
Top 26 out of 100 features being tested
Top 27 out of 100 features being tested
Top 28 out of 100 features being tested
Top 29 out of 100 features being tested
Top 30 out of 100 features being tested
Top 31 out of 100 features being tested
Top 32 out of 100 features being tested
Top 33 out of 100 features being tested
Top 34 out of 100 features being tested
Top 35 out of 100 features being tested
Top 36 out of 100 features being tested
Top 37 out of 100 features being tested
Top 38 out of 100 features being tested
Top 39 out of 100 features being tested
Top 40 out of 100 features being tested
Top 41 out of 100 features being tested
Top 42 out of 100 features being tested
Top 43 out of 100 features being tested
Top 44 out of 100 features being tested
Top 45 out of 100 features being tested
Top 46 out of 100 features being tested
Top 47 out of 100 features being tested
Top 48 out of 100 features being tested
Top 49 out of 100 features being tested
Top 50 out of 100 features being tested
Top 51 out of 100 features being tested
Top 52 out of 100 features being tested
Top 53 out of 100 features being tested
Top 54 out of 100 features being tested
Top 55 out of 100 features being tested
Top 56 out of 100 features being tested
Top 57 out of 100 features being tested
Top 58 out of 100 features being tested
Top 59 out of 100 features being tested
Top 60 out of 100 features being tested
Top 61 out of 100 features being tested
Top 62 out of 100 features being tested
Top 63 out of 100 features being tested
Top 64 out of 100 features being tested
Top 65 out of 100 features being tested
Top 66 out of 100 features being tested
Top 67 out of 100 features being tested
Top 68 out of 100 features being tested
Top 69 out of 100 features being tested
Top 70 out of 100 features being tested
Top 71 out of 100 features being tested
Top 72 out of 100 features being tested
Top 73 out of 100 features being tested
Top 74 out of 100 features being tested
Top 75 out of 100 features being tested
Top 76 out of 100 features being tested
Top 77 out of 100 features being tested
Top 78 out of 100 features being tested
Top 79 out of 100 features being tested
Top 80 out of 100 features being tested
Top 81 out of 100 features being tested
Top 82 out of 100 features being tested
Top 83 out of 100 features being tested
Top 84 out of 100 features being tested
Top 85 out of 100 features being tested
Top 86 out of 100 features being tested
Top 87 out of 100 features being tested
Top 88 out of 100 features being tested
Top 89 out of 100 features being tested
Top 90 out of 100 features being tested
Top 91 out of 100 features being tested
Top 92 out of 100 features being tested
Top 93 out of 100 features being tested
Top 94 out of 100 features being tested
Top 95 out of 100 features being tested
Top 96 out of 100 features being tested
Top 97 out of 100 features being tested
Top 98 out of 100 features being tested
Top 99 out of 100 features being tested
Top 100 out of 100 features being tested
Data saved to /cluster/scratch/hugifl/11_glycomics/AB.h5ad
Data saved to /cluster/scratch/hugifl/11_glycomics/lectin.h5ad
