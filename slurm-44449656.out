/cluster/home/hugifl/scim/utils_data_prep.py:424: FutureWarning: X.dtype being converted to np.float32 from float64. In the next version of anndata (0.9) conversion will not be automatic. Pass dtype explicitly to avoid this warning. Pass `AnnData(X, dtype=X.dtype, ...)` to get the future behavour.
  adata = ad.AnnData(X=data_matrix, obs=metadata)
/cluster/home/hugifl/.local/lib/python3.7/site-packages/anndata/_core/anndata.py:121: ImplicitModificationWarning: Transforming to str index.
  warnings.warn("Transforming to str index.", ImplicitModificationWarning)
computing common genes
number of common genes:  10242
filtering and saving dataset 1
conc:  0.1
conc:  0.25
conc:  0.5
conc:  1
conc:  2
filtering and saving dataset 2
conc:  0.1
conc:  0.5
conc:  1
conc:  2
Number of cells from conc 0.1 before filtering: 1345
Number of cells from conc 0.1 after filtering: 1099
entry of first ADT field: 200.0
shape of adt_data: (1099, 30)
Number of cells from conc 0.25 before filtering: 585
Number of cells from conc 0.25 after filtering: 477
entry of first ADT field: 162.0
shape of adt_data: (477, 30)
Number of cells from conc 0.5 before filtering: 1110
Number of cells from conc 0.5 after filtering: 885
entry of first ADT field: 193.0
shape of adt_data: (885, 30)
Number of cells from conc 1 before filtering: 827
Number of cells from conc 1 after filtering: 684
entry of first ADT field: 225.0
shape of adt_data: (684, 30)
Number of cells from conc 2 before filtering: 1688
Number of cells from conc 2 after filtering: 1401
entry of first ADT field: 216.0
shape of adt_data: (1401, 30)
Number of cells from conc 0.1 before filtering: 553
Number of cells from conc 0.1 after filtering: 472
entry of first ADT field: 1391.0
shape of adt_data: (472, 16)
Number of cells from conc 0.5 before filtering: 1448
Number of cells from conc 0.5 after filtering: 1248
entry of first ADT field: 2819.0
shape of adt_data: (1248, 16)
Number of cells from conc 1 before filtering: 1213
Number of cells from conc 1 after filtering: 1046
entry of first ADT field: 2930.0
shape of adt_data: (1046, 16)
Number of cells from conc 2 before filtering: 1440
Number of cells from conc 2 after filtering: 1212
entry of first ADT field: 1031.0
shape of adt_data: (1212, 16)
initializing and training the Random Forest classifier
predicting on the test set and print the classification report
              precision    recall  f1-score   support

           1       0.90      0.78      0.83        67
           4       0.99      0.97      0.98      2153
           5       0.86      0.95      0.90       338

    accuracy                           0.97      2558
   macro avg       0.91      0.90      0.91      2558
weighted avg       0.97      0.97      0.97      2558

plotting the feature importances
Top 1 out of 100 features being tested
Top 2 out of 100 features being tested
Top 3 out of 100 features being tested
Top 4 out of 100 features being tested
Top 5 out of 100 features being tested
Top 6 out of 100 features being tested
Top 7 out of 100 features being tested
Top 8 out of 100 features being tested
Top 9 out of 100 features being tested
Top 10 out of 100 features being tested
Top 11 out of 100 features being tested
Top 12 out of 100 features being tested
Top 13 out of 100 features being tested
Top 14 out of 100 features being tested
Top 15 out of 100 features being tested
Top 16 out of 100 features being tested
Top 17 out of 100 features being tested
Top 18 out of 100 features being tested
Top 19 out of 100 features being tested
Top 20 out of 100 features being tested
Top 21 out of 100 features being tested
Top 22 out of 100 features being tested
Top 23 out of 100 features being tested
Top 24 out of 100 features being tested
Top 25 out of 100 features being tested
Top 26 out of 100 features being tested
Top 27 out of 100 features being tested
Top 28 out of 100 features being tested
Top 29 out of 100 features being tested
Top 30 out of 100 features being tested
Top 31 out of 100 features being tested
Top 32 out of 100 features being tested
Top 33 out of 100 features being tested
Top 34 out of 100 features being tested
Top 35 out of 100 features being tested
Top 36 out of 100 features being tested
Top 37 out of 100 features being tested
Top 38 out of 100 features being tested
Top 39 out of 100 features being tested
Top 40 out of 100 features being tested
Top 41 out of 100 features being tested
Top 42 out of 100 features being tested
Top 43 out of 100 features being tested
Top 44 out of 100 features being tested
Top 45 out of 100 features being tested
Top 46 out of 100 features being tested
Top 47 out of 100 features being tested
Top 48 out of 100 features being tested
Top 49 out of 100 features being tested
Top 50 out of 100 features being tested
Top 51 out of 100 features being tested
Top 52 out of 100 features being tested
Top 53 out of 100 features being tested
Top 54 out of 100 features being tested
Top 55 out of 100 features being tested
Top 56 out of 100 features being tested
Top 57 out of 100 features being tested
Top 58 out of 100 features being tested
Top 59 out of 100 features being tested
Top 60 out of 100 features being tested
Top 61 out of 100 features being tested
Top 62 out of 100 features being tested
Top 63 out of 100 features being tested
Top 64 out of 100 features being tested
Top 65 out of 100 features being tested
Top 66 out of 100 features being tested
Top 67 out of 100 features being tested
Top 68 out of 100 features being tested
Top 69 out of 100 features being tested
Top 70 out of 100 features being tested
Top 71 out of 100 features being tested
Top 72 out of 100 features being tested
Top 73 out of 100 features being tested
Top 74 out of 100 features being tested
Top 75 out of 100 features being tested
Top 76 out of 100 features being tested
Top 77 out of 100 features being tested
Top 78 out of 100 features being tested
Top 79 out of 100 features being tested
Top 80 out of 100 features being tested
Top 81 out of 100 features being tested
Top 82 out of 100 features being tested
Top 83 out of 100 features being tested
Top 84 out of 100 features being tested
Top 85 out of 100 features being tested
Top 86 out of 100 features being tested
Top 87 out of 100 features being tested
Top 88 out of 100 features being tested
Top 89 out of 100 features being tested
Top 90 out of 100 features being tested
Top 91 out of 100 features being tested
Top 92 out of 100 features being tested
Top 93 out of 100 features being tested
Top 94 out of 100 features being tested
Top 95 out of 100 features being tested
Top 96 out of 100 features being tested
Top 97 out of 100 features being tested
Top 98 out of 100 features being tested
Top 99 out of 100 features being tested
Top 100 out of 100 features being tested
Data saved to /cluster/scratch/hugifl/4_glycomics_7/AB.h5ad
Data saved to /cluster/scratch/hugifl/4_glycomics_7/lectin.h5ad
